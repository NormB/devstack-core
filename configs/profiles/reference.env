# ==============================================================================
# DevStack Core - Reference Profile Environment Overrides
# ==============================================================================
#
# This file contains environment variable overrides for the REFERENCE profile.
# The reference profile includes educational API implementations in multiple
# programming languages demonstrating integration patterns.
#
# SERVICES INCLUDED (5 reference apps):
#   - reference-api:  Python FastAPI code-first implementation
#   - api-first:      Python FastAPI API-first implementation
#   - golang-api:     Go with Gin framework
#   - nodejs-api:     Node.js with Express
#   - rust-api:       Rust with Actix-web (partial, ~40% complete)
#
# IMPORTANT:
#   Reference profile MUST be combined with a base profile (standard or full)
#   that provides infrastructure services (databases, cache, messaging).
#
# RESOURCE USAGE (ADDITIONAL):
#   - RAM:        +1GB (in addition to base profile)
#   - CPU:        +1 core recommended
#   - Disk:       +2GB for images
#   - Startup:    +15 seconds
#
# USAGE:
#   Combine with standard or full profile:
#   docker compose --profile standard --profile reference up -d
#   docker compose --profile full --profile reference up -d
#
# Or use the management script:
#   ./devstack.py start --profile standard --profile reference
#
# ==============================================================================

# ------------------------------------------------------------------------------
# Reference Application Configuration
# ------------------------------------------------------------------------------
# Common configuration for all reference applications.

# Enable reference apps
ENABLE_REFERENCE_APPS=true

# Reference app log level
REFERENCE_API_LOG_LEVEL=info

# Enable metrics export (Prometheus format)
REFERENCE_API_ENABLE_METRICS=true

# Enable TLS/HTTPS endpoints
REFERENCE_API_ENABLE_TLS=true

# Enable structured logging (JSON format)
REFERENCE_API_STRUCTURED_LOGGING=true

# ------------------------------------------------------------------------------
# Python FastAPI Code-First Configuration (port 8000/8443)
# ------------------------------------------------------------------------------
# Comprehensive code-first API implementation.

# HTTP port
FASTAPI_HTTP_PORT=8000

# HTTPS port
FASTAPI_HTTPS_PORT=8443

# Workers (Uvicorn)
FASTAPI_WORKERS=4

# Log level
FASTAPI_LOG_LEVEL=info

# Reload on code changes (development)
FASTAPI_RELOAD=false

# API documentation
FASTAPI_DOCS_ENABLED=true
FASTAPI_DOCS_URL=/docs
FASTAPI_REDOC_URL=/redoc

# CORS configuration
FASTAPI_CORS_ENABLED=true
FASTAPI_CORS_ORIGINS=*

# ------------------------------------------------------------------------------
# Python FastAPI API-First Configuration (port 8001/8444)
# ------------------------------------------------------------------------------
# OpenAPI specification-driven implementation.

# HTTP port
API_FIRST_HTTP_PORT=8001

# HTTPS port
API_FIRST_HTTPS_PORT=8444

# Workers (Uvicorn)
API_FIRST_WORKERS=4

# Log level
API_FIRST_LOG_LEVEL=info

# Reload on code changes
API_FIRST_RELOAD=false

# API documentation
API_FIRST_DOCS_ENABLED=true

# CORS configuration
API_FIRST_CORS_ENABLED=true
API_FIRST_CORS_ORIGINS=*

# OpenAPI spec location
API_FIRST_OPENAPI_SPEC=/app/openapi.yaml

# ------------------------------------------------------------------------------
# Go (Gin) API Configuration (port 8002/8445)
# ------------------------------------------------------------------------------
# Production-ready Go implementation with Gin framework.

# HTTP port
GOLANG_API_HTTP_PORT=8002

# HTTPS port
GOLANG_API_HTTPS_PORT=8445

# Gin mode (release for production-like behavior)
GIN_MODE=release

# Log level
GOLANG_API_LOG_LEVEL=info

# Enable pprof profiling (disabled for release)
GOLANG_API_PPROF_ENABLED=false

# CORS configuration
GOLANG_API_CORS_ENABLED=true

# ------------------------------------------------------------------------------
# Node.js (Express) API Configuration (port 8003/8446)
# ------------------------------------------------------------------------------
# Modern async/await patterns with Express.

# HTTP port
NODEJS_API_HTTP_PORT=8003

# HTTPS port
NODEJS_API_HTTPS_PORT=8446

# Node environment
NODE_ENV=production

# Log level
NODEJS_API_LOG_LEVEL=info

# Enable clustering (disabled for dev)
NODEJS_API_CLUSTER_ENABLED=false

# CORS configuration
NODEJS_API_CORS_ENABLED=true

# ------------------------------------------------------------------------------
# Rust (Actix-web) API Configuration (port 8004/8447)
# ------------------------------------------------------------------------------
# High-performance async API (partial implementation, ~40% complete).

# HTTP port
RUST_API_HTTP_PORT=8004

# HTTPS port
RUST_API_HTTPS_PORT=8447

# Rust log level
RUST_LOG=info

# Actix workers
RUST_API_WORKERS=4

# CORS configuration
RUST_API_CORS_ENABLED=true

# ------------------------------------------------------------------------------
# Shared Database Configuration
# ------------------------------------------------------------------------------
# All reference apps use the same infrastructure services.

# PostgreSQL connection (from standard/full profile)
REFERENCE_POSTGRES_HOST=postgres
REFERENCE_POSTGRES_PORT=5432

# MySQL connection (from standard/full profile)
REFERENCE_MYSQL_HOST=mysql
REFERENCE_MYSQL_PORT=3306

# MongoDB connection (from standard/full profile)
REFERENCE_MONGODB_HOST=mongodb
REFERENCE_MONGODB_PORT=27017

# Redis connection (cluster or standalone)
REFERENCE_REDIS_HOST=redis-1
REFERENCE_REDIS_PORT=6379

# RabbitMQ connection (from standard/full profile)
REFERENCE_RABBITMQ_HOST=rabbitmq
REFERENCE_RABBITMQ_PORT=5672
REFERENCE_RABBITMQ_MANAGEMENT_PORT=15672

# Vault connection (always available)
REFERENCE_VAULT_ADDR=http://vault:8200

# ------------------------------------------------------------------------------
# Health Check Configuration
# ------------------------------------------------------------------------------
# Health check settings for reference applications.

# FastAPI code-first
FASTAPI_HEALTH_INTERVAL=30s
FASTAPI_HEALTH_TIMEOUT=5s
FASTAPI_HEALTH_RETRIES=5
FASTAPI_HEALTH_START_PERIOD=20s

# FastAPI API-first
API_FIRST_HEALTH_INTERVAL=30s
API_FIRST_HEALTH_TIMEOUT=5s
API_FIRST_HEALTH_RETRIES=5
API_FIRST_HEALTH_START_PERIOD=20s

# Go API
GOLANG_API_HEALTH_INTERVAL=30s
GOLANG_API_HEALTH_TIMEOUT=5s
GOLANG_API_HEALTH_RETRIES=5
GOLANG_API_HEALTH_START_PERIOD=20s

# Node.js API
NODEJS_API_HEALTH_INTERVAL=30s
NODEJS_API_HEALTH_TIMEOUT=5s
NODEJS_API_HEALTH_RETRIES=5
NODEJS_API_HEALTH_START_PERIOD=20s

# Rust API
RUST_API_HEALTH_INTERVAL=30s
RUST_API_HEALTH_TIMEOUT=5s
RUST_API_HEALTH_RETRIES=5
RUST_API_HEALTH_START_PERIOD=20s

# ------------------------------------------------------------------------------
# Resource Limits - Reference Applications
# ------------------------------------------------------------------------------
# Conservative resource limits for reference apps.

# Python FastAPI code-first
FASTAPI_MEMORY_LIMIT=512M
FASTAPI_MEMORY_RESERVATION=256M
FASTAPI_CPU_LIMIT=1.0

# Python FastAPI API-first
API_FIRST_MEMORY_LIMIT=512M
API_FIRST_MEMORY_RESERVATION=256M
API_FIRST_CPU_LIMIT=1.0

# Go API
GOLANG_API_MEMORY_LIMIT=256M
GOLANG_API_MEMORY_RESERVATION=128M
GOLANG_API_CPU_LIMIT=0.5

# Node.js API
NODEJS_API_MEMORY_LIMIT=512M
NODEJS_API_MEMORY_RESERVATION=256M
NODEJS_API_CPU_LIMIT=1.0

# Rust API
RUST_API_MEMORY_LIMIT=256M
RUST_API_MEMORY_RESERVATION=128M
RUST_API_CPU_LIMIT=0.5

# ------------------------------------------------------------------------------
# Testing Configuration
# ------------------------------------------------------------------------------
# Configuration for running tests against reference apps.

# Enable test endpoints (should be disabled in production)
ENABLE_TEST_ENDPOINTS=true

# Test database credentials (use Vault in real scenarios)
TEST_DATABASE_AUTO_CLEANUP=true

# Shared test suite configuration
SHARED_TEST_SUITE_ENABLED=true
SHARED_TEST_PARALLEL=true

# ------------------------------------------------------------------------------
# Performance Benchmarking
# ------------------------------------------------------------------------------
# Settings for performance benchmarks across implementations.

# Enable performance endpoints
ENABLE_PERFORMANCE_ENDPOINTS=true

# Benchmark iterations
BENCHMARK_ITERATIONS=1000

# Benchmark concurrency
BENCHMARK_CONCURRENCY=10

# ------------------------------------------------------------------------------
# Development Settings
# ------------------------------------------------------------------------------
# Development-specific settings for reference apps.

# Hot reload (disabled for stability)
ENABLE_HOT_RELOAD=false

# Debug mode (disabled for production-like behavior)
DEBUG_MODE=false

# Verbose errors (enabled for learning)
VERBOSE_ERRORS=true

# API versioning
API_VERSION=v1

# ------------------------------------------------------------------------------
# Security Settings
# ------------------------------------------------------------------------------
# Security settings for reference applications.

# CORS (enabled for local development)
CORS_ENABLED=true
CORS_ALLOW_ORIGINS=*
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_ALLOW_HEADERS=*

# Rate limiting (disabled for testing)
RATE_LIMITING_ENABLED=false

# Authentication (simplified for examples)
AUTH_ENABLED=false
AUTH_TYPE=none

# ------------------------------------------------------------------------------
# Logging Configuration
# ------------------------------------------------------------------------------
# Enhanced logging for reference applications.

# Log level
LOG_LEVEL=info

# Structured logging
LOG_FORMAT=json

# Include request IDs
LOG_INCLUDE_REQUEST_ID=true

# Log database queries (disabled for performance)
LOG_DATABASE_QUERIES=false

# ------------------------------------------------------------------------------
# API Documentation URLs
# ------------------------------------------------------------------------------
# Access API documentation at these URLs:
#
# Python FastAPI Code-First:
#   OpenAPI UI:  http://localhost:8000/docs
#   ReDoc:       http://localhost:8000/redoc
#   OpenAPI spec: http://localhost:8000/openapi.json
#
# Python FastAPI API-First:
#   OpenAPI UI:  http://localhost:8001/docs
#   ReDoc:       http://localhost:8001/redoc
#   OpenAPI spec: http://localhost:8001/openapi.json
#
# Go (Gin):
#   API info:    http://localhost:8002/
#   Health:      http://localhost:8002/health
#   Metrics:     http://localhost:8002/metrics
#
# Node.js (Express):
#   API info:    http://localhost:8003/
#   Health:      http://localhost:8003/health
#   Metrics:     http://localhost:8003/metrics
#
# Rust (Actix-web):
#   API info:    http://localhost:8004/
#   Health:      http://localhost:8004/health
#   Metrics:     http://localhost:8004/metrics
#
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# Running Tests
# ------------------------------------------------------------------------------
# Test reference applications:
#
# Python unit tests (inside container):
#   docker exec dev-reference-api pytest tests/ -v
#
# Parity tests (from host with uv):
#   cd reference-apps/shared/test-suite
#   uv run pytest -v
#
# Performance benchmarks:
#   ./tests/performance-benchmark.sh
#
# Individual language tests:
#   ./tests/test-fastapi.sh
#   ./tests/test-rust.sh
#
# All tests:
#   ./tests/run-all-tests.sh
#
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# Notes
# ------------------------------------------------------------------------------
#
# 1. DEPENDENCIES:
#    - Reference apps REQUIRE infrastructure services
#    - Must combine with standard or full profile
#    - Cannot run reference profile standalone
#
# 2. RESOURCE USAGE:
#    - Total additional: ~1GB RAM
#    - Python FastAPI (2): ~1GB combined
#    - Go: ~256MB
#    - Node.js: ~512MB
#    - Rust: ~256MB
#
# 3. STARTUP TIME:
#    - Expected: +10-20 seconds additional
#    - Python apps: 5-10s each
#    - Go: 2-3s (compiled binary)
#    - Node.js: 3-5s
#    - Rust: 2-3s (compiled binary)
#
# 4. IMPLEMENTATION STATUS:
#    - Python FastAPI code-first: ✓ Complete (254 unit tests)
#    - Python FastAPI API-first: ✓ Complete (64 parity tests)
#    - Go: ✓ Complete with GoDoc
#    - Node.js: ✓ Complete with Jest tests
#    - Rust: ⚠ Partial (~40% complete, 16 tests)
#
# 5. LEARNING RESOURCES:
#    - Each implementation has detailed README in reference-apps/<language>/
#    - Shared patterns documented in reference-apps/README.md
#    - API design patterns in reference-apps/API_PATTERNS.md
#
# 6. USE CASES:
#    - Learning API design patterns
#    - Comparing language implementations
#    - Testing integration patterns
#    - Performance benchmarking
#    - Example code for your applications
#
# ==============================================================================
